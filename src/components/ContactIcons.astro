---
// src/components/ContactIcons.astro
// Componente: modal de contato com WhatsApp e Instagram
---
<style>
/* básico, sem Tailwind para máxima compatibilidade */
.contact-btn { background:#F2C94C; color:#0F172A; padding:10px 14px; border-radius:10px; font-weight:700; border:0; cursor:pointer; }
.modal-backdrop{position:fixed;inset:0;background:rgba(3,10,18,0.5);display:none;align-items:center;justify-content:center;z-index:1200}
.modal{background:#fff;border-radius:12px;padding:20px;max-width:520px;width:92%;box-shadow:0 20px 50px rgba(2,6,23,0.35);text-align:center}
.modal h2{margin:0 0 8px 0;color:#083f73}
.icons{display:flex;gap:20px;align-items:center;justify-content:center;margin-top:14px}
.icon-link{display:inline-flex;flex-direction:column;align-items:center;text-decoration:none;color:inherit}
.icon-circle{width:110px;height:110px;border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 8px 20px rgba(3,10,23,0.08)}
.whatsapp{background:linear-gradient(180deg,#25D366,#1DA851);color:#fff}
.instagram{background:linear-gradient(45deg,#feda75,#d62976,#962fbf,#4f5bd5);color:#fff}
.icon-label{margin-top:8px;font-weight:700;font-size:0.95rem;color:#083f73}
.close-x{position:absolute;right:12px;top:12px;background:transparent;border:0;font-size:20px;cursor:pointer;color:#64748b}
@media(max-width:520px){ .icon-circle{width:86px;height:86px;font-size:20px} }
</style>

<button class="contact-btn" id="contact-open" aria-haspopup="dialog" aria-controls="contact-modal">Entrar em contato</button>

<div id="contact-modal-backdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal" id="contact-modal" role="document">
    <button class="close-x" id="contact-close" aria-label="Fechar">✕</button>
    <h2>Fale com a escola</h2>
    <p style="margin:6px 0 0 0;color:#475569">Escolha um dos canais abaixo:</p>

    <div class="icons" role="group" aria-label="Canais de contato">
      <!-- WhatsApp -->
      <a class="icon-link" id="wa-link" href="https://wa.me/556900000000" target="_blank" rel="noopener noreferrer">
        <div class="icon-circle whatsapp" aria-hidden="true">
          <!-- WhatsApp SVG -->
          <svg width="46" height="46" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path fill="#fff" d="M12.04 2C6.5 2 2 6.48 2 12c0 1.98.52 3.84 1.42 5.45L2 22l4.7-1.36A9.94 9.94 0 0012.04 22C17.58 22 22.08 17.52 22.08 12S17.58 2 12.04 2zm0 17.2c-1.5 0-2.96-.4-4.22-1.16l-.3-.18-2.8.82.8-2.73-.19-.3A7.12 7.12 0 014.92 12c0-3.42 2.76-6.2 7.12-6.2 3.92 0 6.82 2.86 6.82 6.2s-2.9 6.2-6.82 6.2z"/>
            <path fill="#fff" d="M17.2 14.54c-.3-.15-1.74-.86-2.01-.96-.27-.1-.47-.15-.67.15-.2.3-.78.96-.96 1.16-.18.2-.36.22-.66.07-.3-.15-1.27-.47-2.42-1.48-.9-.8-1.5-1.78-1.67-2.08-.17-.3-.02-.46.13-.61.14-.14.3-.36.45-.54.15-.18.2-.3.3-.5.1-.2 0-.4-.01-.56-.01-.16-.67-1.6-.92-2.2-.24-.57-.48-.49-.66-.5-.17-.01-.37-.01-.57-.01-.2 0-.52.07-.79.35-.27.28-1.05 1.03-1.05 2.5 0 1.47 1.08 2.9 1.23 3.1.15.2 2.12 3.22 5.13 4.52 3.01 1.3 3.01.87 3.56.82.56-.05 1.74-.69 1.99-1.37.25-.68.25-1.26.17-1.37-.08-.11-.27-.17-.57-.31z"/>
          </svg>
        </div>
        <div class="icon-label">WhatsApp</div>
      </a>

      <!-- Instagram -->
      <a class="icon-link" id="ig-link" href="https://instagram.com/escola_user" target="_blank" rel="noopener noreferrer">
        <div class="icon-circle instagram" aria-hidden="true">
          <!-- Instagram SVG -->
          <svg width="46" height="46" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path fill="#fff" d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 5.9A3.1 3.1 0 1015.1 11 3.1 3.1 0 0012 7.9zm4.2-.9a1.2 1.2 0 11-1.2 1.2 1.2 1.2 0 011.2-1.2z"/>
            <circle cx="12" cy="11" r="2.3" fill="#fff"/>
          </svg>
        </div>
        <div class="icon-label">Instagram</div>
      </a>
    </div>

    <p style="margin-top:14px;color:#64748b;font-size:13px">Ao clicar no ícone, você será redirecionado ao aplicativo/conta correspondente.</p>
  </div>
</div>

<script>
  // JS simples — funciona sem bundler; abre/fecha modal e foca acessível
  (function(){
    const openBtn = document.getElementById('contact-open');
    const modalBack = document.getElementById('contact-modal-backdrop');
    const modal = document.getElementById('contact-modal');
    const closeBtn = document.getElementById('contact-close');
    function openModal(){
      modalBack.style.display='flex';
      modalBack.setAttribute('aria-hidden','false');
      // foco no primeiro link
      const first = modal.querySelector('a.icon-link');
      if(first) first.focus();
      // trap focus (very simple)
      document.addEventListener('keydown', escHandler);
    }
    function closeModal(){
      modalBack.style.display='none';
      modalBack.setAttribute('aria-hidden','true');
      openBtn.focus();
      document.removeEventListener('keydown', escHandler);
    }
    function escHandler(e){ if(e.key==='Escape') closeModal(); }
    openBtn.addEventListener('click', openModal);
    closeBtn.addEventListener('click', closeModal);
    modalBack.addEventListener('click', (e)=>{
      if(e.target===modalBack) closeModal();
    });
  })();
</script>
